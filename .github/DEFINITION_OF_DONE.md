# Definition of Done (DoD)

このプロジェクトでは、以下のDefinition of Done（完成の定義）に基づき、スプリント成果物の品質を担保します。

## 🎯 基本原則

- **ユーザー指示・制約事項の最優先遵守**
- **mainブランチは常にリリース可能な状態を維持**
- **品質ゲートをクリアした成果物のみmainへマージ**

## ✅ Definition of Done チェックリスト

### 1. 機能要件の達成
- [ ] 受け入れ基準（Acceptance Criteria）を満たしている
- [ ] ユーザーストーリーの全ての要件が実装されている
- [ ] 既存機能への影響がないことを確認済み

### 2. 品質基準の達成
- [ ] TypeScript strict modeでの型エラーがない
- [ ] ESLintのwarning/errorが0件
- [ ] テストカバレッジが80%以上（該当する場合）
- [ ] 単体テスト・統合テストが全て通過
- [ ] 手動テストでユーザー体験を確認済み

### 3. セキュリティ・プロトコル準拠
- [ ] セキュリティ監査（npm audit）が通過
- [ ] MCPプロトコル仕様に準拠している
- [ ] APIキー・認証情報がリポジトリに含まれていない
- [ ] 外部API連携のエラーハンドリングが適切

### 4. コード品質
- [ ] コードレビューが完了している
- [ ] リファクタリングが必要な技術的負債がない
- [ ] ログ出力がstderrに適切に設定されている（MCPサーバー）
- [ ] エラーハンドリングが適切に実装されている

### 5. ドキュメント・透明性
- [ ] README.mdが更新されている（機能追加の場合）
- [ ] APIドキュメントが更新されている（該当する場合）
- [ ] リリースノートが作成されている
- [ ] 変更履歴がコミットメッセージに適切に記録されている

### 6. 運用・制約管理
- [ ] ユーザーからの明示的な実装許可を得ている
- [ ] バックログ項目の意図（既存変更/新規追加）が明確
- [ ] CI/CDパイプラインが全て成功している
- [ ] ブランチ戦略に従ったPR・マージ手順を遵守

### 7. リリース準備
- [ ] 本番環境での動作確認が完了（該当する場合）
- [ ] パフォーマンスに問題がない
- [ ] ロールバック手順が確認されている
- [ ] リリース後の監視計画が準備されている

## 🚨 品質ゲート失敗時の対応

1. **mainマージの停止**: DoDを満たさない成果物はmainへマージしない
2. **問題の修正**: 失敗した項目を特定し、修正作業を実施
3. **再検証**: 修正後、再度DoDチェックリストを実行
4. **学習の記録**: 問題の原因と再発防止策を知識管理システムに記録

## 📊 品質メトリクス

以下のメトリクスを定期的に監視し、品質向上に活用します：

- テストカバレッジ率
- CI/CDパイプライン成功率
- PR承認までの平均時間
- バグ発見率（Sprint内/リリース後）
- ユーザー報告の問題件数

## 🔄 継続的改善

- スプリントレトロスペクティブでDoDの運用状況を振り返り
- 必要に応じてDoDの項目を追加・修正
- チーム全体での品質意識向上を継続

---

**このDoDは全チームメンバーが遵守すべき品質基準です。**  
**不明な点がある場合は、Scrum MasterまたはQAエンジニアに確認してください。**
